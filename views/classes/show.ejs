<%- include('../partials/header') %>

    <section id="show-page">
        <div>Title: </div>
        <div>
            <%= classes.title %>
        </div>
        <div>Subject: </div>
        <div>
            <%= classes.subject %>
        </div>
        <div>instructor: </div>
        <div>
            <%= classes.instructor %>
        </div>
        <div>Difficulty: </div>
        <div>
            <%=classes.difficulty%>
        </div>
        <a href="/classes/new">Enrollment Page</a>
    </section>
    <section class="reviews-form">
        <form method="POST" action="/classes/<%= classes._id %>/reviews">
            <label>Review:</label>
            <textarea name="content"></textarea>
            <label>Rating:</label>
            <select name="rating">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3" selected>3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
            <input type="submit" value="Add Review">
        </form>
    </section>
    <section class="reviews">
        <% if (classes.reviews.length) { %>
            <thead>
                <tr>
                    <th>User</th>
                    <th>Date</th>
                    <th>Review</th>
                    <th>Rating</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>

                <% classes.reviews.forEach(function(r) { %>

                    <tr>
                        <td class="review-user"><img alt="avatar" src="<%= r.userAvatar %>">
                            <%= r.userName %>
                        </td>
                        <td>
                            <%= r.createdAt.toLocaleDateString() %>
                        </td>
                        <td>
                            <%= r.content %>
                        </td>
                        <td>
                            <%= r.rating %>
                        </td>
                        <td>
                            <% if(user && user._id.equals(r.user)) { %>
                                <form action="/reviews/<%=r._id %>?_method=DELETE" method="POST">
                                    <button type="submit">X</button>
                                </form>
                                <% } %>
                        </td>
                    </tr>
                    <% }); %>

            </tbody>
            </table>
            <% } else { %>
                <h5>No Reviews Yet</h5>
                <% } %>
    </section>
    <%- include('../partials/footer') %>